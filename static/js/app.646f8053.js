(function(){var t={1049:function(t,e,s){"use strict";var a=s(9242),n=s(3396),o=s(7139),r=s(4617);const i={key:0},u={class:"clear-storage"},l=(0,n._)("img",{src:r,alt:"Отчистка данных",class:"clear-icon"},null,-1),c=[l],d={key:1},p=(0,n._)("div",{class:"d-flex justify-content-center align-items-center spinner"},null,-1),h=[p],g={class:"container"},m={class:"block total-div"},y={class:"one-div-in-total justify-content-end row"},f={class:"col-md-6 text-center my-3"},v=(0,n._)("h3",{class:"suggest-label"},"Точки отправления",-1),b={class:"col-md-6 text-center my-3"},M=(0,n._)("h3",{class:"suggest-label"},"Точки назначения",-1),I={key:0,class:"two-div-in-total"},k=(0,n._)("i",{class:"fa fa-map"},null,-1),C=[k],_={class:"row my-5 setting block"},w={class:"col-4"},S={class:"col-4 text-center"},L={class:"col-4 text-center"},O={class:"route-calculation text-center my-5"},D={key:0,class:"total-div"},A={class:"two-div-in-total"},T=["href"],N=(0,n._)("i",{class:"fa fa-file-excel"},null,-1),x=[N],j=(0,n._)("footer",{class:"footer"},null,-1);function E(t,e,s,a,r,l){const p=(0,n.up)("yandex-markers"),k=(0,n.up)("yandex-map"),N=(0,n.up)("my-suggests"),E=(0,n.up)("my-capacity"),U=(0,n.up)("type-transport"),R=(0,n.up)("type-metrics"),P=(0,n.up)("route-calculation"),q=(0,n.up)("table-result");return(0,n.wg)(),(0,n.iD)(n.HY,null,[t.isEmptyLocalStorage?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",i,[(0,n._)("div",u,[(0,n._)("button",{onClick:e[0]||(e[0]=(...t)=>l.RemoveLocalData&&l.RemoveLocalData(...t)),class:"clear-button"},c)])])),t.isInputDisabled?((0,n.wg)(),(0,n.iD)("div",d,h)):(0,n.kq)("",!0),t.errorMessage.length>0?((0,n.wg)(),(0,n.iD)("div",{key:2,class:"alert alert-danger error-alert",role:"alert",onClick:e[1]||(e[1]=e=>t.errorMessage="")},(0,o.zw)(t.errorMessage),1)):(0,n.kq)("",!0),(0,n._)("div",g,[((0,n.wg)(),(0,n.j4)(k,{key:t.mainMap.id,center:[55.751244,37.618423],zoom:12},{default:(0,n.w5)((()=>[(0,n.Wm)(p,{markers:l.filteredMarkers,mapId:t.mainMap.id,onUpdateMarkerObjectEvent:l.updateMarkerObject},null,8,["markers","mapId","onUpdateMarkerObjectEvent"])])),_:1})),(0,n._)("div",m,[(0,n._)("div",y,[(0,n._)("div",f,[v,(0,n.Wm)(N,{suggests:t.suggestsStore,onUpdateInputEvent:l.updateInput,onUpdateCountEvent:l.updateCount,onClickOnlyNeedRoutesButtonEvent:l.OnlyNeedRoutesToMap},null,8,["suggests","onUpdateInputEvent","onUpdateCountEvent","onClickOnlyNeedRoutesButtonEvent"])]),(0,n._)("div",b,[M,(0,n.Wm)(N,{suggests:t.suggestsDestination,onUpdateInputEvent:l.updateInput,onUpdateCountEvent:l.updateCount,onClickOnlyNeedRoutesButtonEvent:l.OnlyNeedRoutesToMap},null,8,["suggests","onUpdateInputEvent","onUpdateCountEvent","onClickOnlyNeedRoutesButtonEvent"])])]),t.routes.atMapObjects.length>0?((0,n.wg)(),(0,n.iD)("div",I,[(0,n._)("button",{class:"fa-btn",onClick:e[2]||(e[2]=(...t)=>l.AllRoutesToMap&&l.AllRoutesToMap(...t))},C)])):(0,n.kq)("",!0)]),(0,n._)("div",_,[(0,n._)("div",w,[(0,n.Wm)(E,{capacity:t.capacity,onUpdateCapacityEvent:l.updateCapacity},null,8,["capacity","onUpdateCapacityEvent"])]),(0,n._)("div",S,[(0,n.Wm)(U,{"type-transport":t.typeTransport,onTypeTransportUpdateEvent:l.typeTransportUpdate},null,8,["type-transport","onTypeTransportUpdateEvent"])]),(0,n._)("div",L,[(0,n.Wm)(R,{"type-measurement":t.typeMeasurement,onTypeMeasurementUpdateEvent:l.typeMeasurementUpdate},null,8,["type-measurement","onTypeMeasurementUpdateEvent"])])]),(0,n._)("div",O,[(0,n.Wm)(P,{storeCoords:l.filteredStoreCoords,destinationCoords:l.filteredDestinationCoords,storeCount:l.storeCount,destinationCount:l.destinationCount,capacity:t.capacity,IsMinCoords:l.IsMinCoords,typeTransport:t.typeTransport,typeMeasurement:t.typeMeasurement,onUpdateRoutesEvent:l.updateRoutes,onErrorResultEvent:l.showErrorMessage},null,8,["storeCoords","destinationCoords","storeCount","destinationCount","capacity","IsMinCoords","typeTransport","typeMeasurement","onUpdateRoutesEvent","onErrorResultEvent"])]),t.table.body.length>0?((0,n.wg)(),(0,n.iD)("div",D,[(0,n.Wm)(q,{class:"one-div-in-total",table:this.table},null,8,["table"]),(0,n._)("div",A,[(0,n._)("a",{class:"fa-btn",href:l.excelLink,download:"routes.xlsx"},x,8,T)])])):(0,n.kq)("",!0),j])],64)}s(7658);var U=s(65);function R(t,e,s,a,o,r){const i=(0,n.up)("my-suggest");return(0,n.wg)(),(0,n.iD)("div",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.suggests.values,((t,e)=>((0,n.wg)(),(0,n.j4)(i,{class:"mx-3",key:t.id,"suggest-number":e+1,"suggest-value":t.value,count:t.count,atMapObjectsIndexes:t.atMapObjectsIndexes,onUpdateInputEvent:t=>r.updateInput(t,e),onUpdateCountEvent:t=>r.updateCount(t,e),onClickOnlyNeedRoutesButtonEvent:r.ClickOnlyNeedRoutesButtonEvent},null,8,["suggest-number","suggest-value","count","atMapObjectsIndexes","onUpdateInputEvent","onUpdateCountEvent","onClickOnlyNeedRoutesButtonEvent"])))),128))])}const P={class:"inputs row"},q={class:"col-1"},B={key:0},G={class:"fa-btn"},Y={class:"number col-1"},$={key:0},V={class:"input col-8"},W={class:"suggest-input"},Z=["value","readonly"],z={class:"input col-2"},H={class:"count-input"},K=["value"];function F(t,e,s,a,r,i){return(0,n.wg)(),(0,n.iD)("div",null,[(0,n._)("div",P,[(0,n._)("div",q,[s.atMapObjectsIndexes.__v_raw.length>0?((0,n.wg)(),(0,n.iD)("div",B,[(0,n._)("button",G,[(0,n._)("i",{class:"fa fa-map-marker","aria-hidden":"true",onClick:e[0]||(e[0]=(...t)=>i.ClickOnlyNeedRoutesButtonEvent&&i.ClickOnlyNeedRoutesButtonEvent(...t))})])])):(0,n.kq)("",!0)]),(0,n._)("div",Y,[s.suggestValue.length>0?((0,n.wg)(),(0,n.iD)("div",$,[(0,n._)("h4",null,(0,o.zw)(s.suggestNumber),1)])):(0,n.kq)("",!0)]),(0,n._)("div",V,[(0,n._)("div",W,[(0,n._)("input",{placeholder:"Адрес",value:s.suggestValue,readonly:t.isInputDisabled,onBlur:e[1]||(e[1]=(...t)=>i.changeUpdateInput&&i.changeUpdateInput(...t)),onChange:e[2]||(e[2]=(...t)=>i.changeUpdateInput&&i.changeUpdateInput(...t)),onInput:e[3]||(e[3]=(...t)=>i.updateInput&&i.updateInput(...t)),type:"text",ref:"refInput"},null,40,Z)])]),(0,n._)("div",z,[(0,n._)("div",H,[(0,n._)("input",{class:"px-0",value:s.count,type:"number",min:1,max:1e5,onInput:e[4]||(e[4]=(...t)=>i.updateCount&&i.updateCount(...t))},null,40,K)])])])])}var J={name:"my-suggest",data:()=>({}),props:{suggestNumber:{type:Number,required:!0},suggestValue:{type:String,required:!0},count:{type:Number,required:!0},atMapObjectsIndexes:{type:Array,required:!0,deep:!0}},methods:{updateInput(t){this.$emit("updateInputEvent",t.target.value)},changeUpdateInput(t){setTimeout((()=>{this.updateInput(t)}),200)},updateCount(t){this.$emit("updateCountEvent",t.target.value)},ClickOnlyNeedRoutesButtonEvent(){this.$emit("ClickOnlyNeedRoutesButtonEvent",this.atMapObjectsIndexes.__v_raw)},initializeSuggestView(){new window.ymaps.SuggestView(this.$refs.refInput,{options:{itemLayout:'<span class="ymaps-suggest-view-item">{{ data.value }}</span>'}})}},mounted(){let t=(0,U.oR)();t.state.YAPIModule.connected?this.initializeSuggestView():(0,n.YP)((()=>t.state.YAPIModule.connected),(t=>{t&&this.initializeSuggestView()}))},computed:{...(0,U.rn)("GlobalSettingModule",["isInputDisabled"])}},Q=s(89);const X=(0,Q.Z)(J,[["render",F]]);var tt=X,et={name:"my-suggests",components:{MySuggest:tt},data(){return{}},props:{suggests:{type:Object,required:!0}},methods:{updateInput(t,e){const s=this.suggests;this.$emit("updateInputEvent",t,e,s)},updateCount(t,e){const s=this.suggests;this.$emit("updateCountEvent",t,e,s)},ClickOnlyNeedRoutesButtonEvent(t){this.$emit("ClickOnlyNeedRoutesButtonEvent",t)}}};const st=(0,Q.Z)(et,[["render",R]]);var at=st,nt=s(536);function ot(t,e,s,a,o,r){const i=(0,n.up)("yandex-marker");return(0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.markers,((t,e)=>((0,n.wg)(),(0,n.iD)("div",{class:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",key:t.id},[(0,n.Wm)(i,{"marker-number":"store"===t.type?e+1:e+1-r.markersStoreCount,coords:t.coords,object:t.object,type:t.type,onUpdateMarkerObjectEvent:t=>r.updateMarkerObject(t,e)},null,8,["marker-number","coords","object","type","onUpdateMarkerObjectEvent"])])))),128)}const rt={style:{display:"none"}};function it(t,e,s,a,o,r){return(0,n.wg)(),(0,n.iD)("div",rt)}var ut={name:"yandex-marker",props:{markerNumber:{type:Number,required:!0},coords:{type:Object,required:!0},object:{type:Object,required:!0},type:{type:String,required:!0}},methods:{},setup(t,{emit:e}){let a=(0,U.oR)();const o=t=>{e("updateMarkerObjectEvent",t)},r=()=>{let e=a.state.MainMapModule.MainMap.__v_raw;if(null!=t.object&&(e.geoObjects.remove(t.object.__v_raw),o(null)),null!=t.coords){let a=19-3*t.markerNumber.toString().length,n=window.ymaps.templateLayoutFactory.createClass('<div style="color: #000000; margin-left: 17px;  margin-top: 11px; width: 27px; text-align: center; font-weight: bold; font-size: '+a+'px ">$[properties.iconContent]</div>'),r=new window.ymaps.Placemark(t.coords,{hintContent:"Собственный значок метки с контентом",balloonContent:"А эта — новогодняя",iconContent:t.markerNumber},{iconImageHref:s(4700)("./"+t.type+"Icon.png"),iconImageSize:[60,60],iconOffset:[-30,-55],iconLayout:"default#imageWithContent",iconContentLayout:n});e.geoObjects.add(r),o(r),e.setCenter(t.coords,15)}};return null!==t.coords&&r(),(0,n.YP)((()=>t.coords),r,{deep:!0}),[]}};const lt=(0,Q.Z)(ut,[["render",it]]);var ct=lt,dt={name:"yandex-markers",components:{YandexMarker:ct},props:{markers:{type:Array,required:!0}},methods:{updateMarkerObject(t,e){this.$emit("updateMarkerObjectEvent",t,e,this.markers)}},computed:{markersStoreCount(){return this.markers.filter((t=>"store"===t.type)).length}}};const pt=(0,Q.Z)(dt,[["render",ot]]);var ht=pt;const gt=["disabled"];function mt(t,e,s,a,o,r){return(0,n.wg)(),(0,n.iD)("button",{class:"btn btn-primary route-calculation-button",onClick:e[0]||(e[0]=(...t)=>r.SubmitCoords&&r.SubmitCoords(...t)),disabled:r.isButtonDisabled},"Расчитать маршруты",8,gt)}var yt=s(2584),ft={name:"route-calculation",props:{storeCoords:{type:Array,required:!0},destinationCoords:{type:Array,required:!0},storeCount:{type:Array,required:!0},destinationCount:{type:Array,required:!0},capacity:{type:Number,required:!0},IsMinCoords:{type:Boolean,required:!0},typeTransport:{type:String,required:!0},typeMeasurement:{type:String,required:!0}},setup(){const t=(0,U.oR)(),e=new yt.Z.Matrix({api_key:"5b3ce3597851110001cf624817bc7afc92314896893a12f1234acd86"});return{store:t,orsMatrix:e}},methods:{GiveResult(t){this.$emit("updateRoutesEvent",t)},ErrorResult(){this.$emit("ErrorResultEvent")},SubmitCoords(){this.DistanceCalculationRoutesByOpenRouteAPI().then((t=>{if(t.metrics.flat().indexOf(null)>-1)return void this.ErrorResult();let e=t.storeLen,s=t.metrics.slice(0,e),a=t.metrics.slice(e),n={distances:s,storeCount:this.storeCount,destinationCount:this.destinationCount,capacity:this.capacity,distanceBetweenDestinations:a};this.$store.commit("GlobalSettingModule/setIsInputDisabled",!0),fetch("http://127.0.0.1:8080/build",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((t=>t.json())).then((t=>{this.GiveResult(t),this.$store.commit("GlobalSettingModule/setIsInputDisabled",!1)})).catch((t=>{this.$store.commit("GlobalSettingModule/setIsInputDisabled",!1),console.error("Ошибка:",t)}))})).catch((t=>{console.error(t)}))},DistanceCalculationRoutesByOpenRouteAPI(){let t=this.storeNotNULL.length,e=this.storeNotNULL.length,s=this.typeMeasurement;return new Promise(((a,n)=>{this.orsMatrix.calculate({locations:this.locations.concat(this.destinationsNotNULL),sources:this.storeIndexes.concat(this.destinationsAsStoreIndexes),destinations:this.destinationsIndexes,profile:this.TypeTransportOpenRouteService,metrics:["distance","duration"]}).then((n=>{a({metrics:n[s],storeLen:t,destinationLen:e})})).catch((t=>{n(t)}))}))}},computed:{locations(){return this.storeNotNULL.concat(this.destinationsNotNULL)},storeIndexes(){return Array.from({length:this.storeNotNULL.length},((t,e)=>e))},destinationsIndexes(){return Array.from({length:this.destinationsNotNULL.length},((t,e)=>this.storeNotNULL.length+e))},destinationsAsStoreIndexes(){return Array.from({length:this.destinationsNotNULL.length},((t,e)=>this.storeNotNULL.length+this.destinationsNotNULL.length+e))},storeNotNULL(){return this.storeCoords.filter((t=>null!==t)).map((t=>[t[1],t[0]]))},destinationsNotNULL(){return this.destinationCoords.filter((t=>null!==t)).map((t=>[t[1],t[0]]))},isButtonDisabled(){return!this.IsMinCoords||this.isInputDisabled},TypeTransportOpenRouteService(){switch(this.typeTransport){case"auto":return"driving-car";case"bicycle":return"cycling-regular";case"pedestrian":return"foot-walking"}return null},...(0,U.rn)("GlobalSettingModule",["isInputDisabled"])}};const vt=(0,Q.Z)(ft,[["render",mt],["__scopeId","data-v-1c3c6d90"]]);var bt=vt;const Mt=t=>((0,n.dD)("data-v-a96af45a"),t=t(),(0,n.Cn)(),t),It={class:"input text-center"},kt=Mt((()=>(0,n._)("h5",null,"Вместительность транспорта",-1))),Ct={class:"count-input col-4 mx-auto"},_t=["value"];function wt(t,e,s,a,o,r){return(0,n.wg)(),(0,n.iD)("div",It,[kt,(0,n._)("div",Ct,[(0,n._)("input",{value:s.capacity,type:"number",min:"0",max:"1111111",onBlur:e[0]||(e[0]=(...t)=>r.capacityInput&&r.capacityInput(...t)),onChange:e[1]||(e[1]=(...t)=>r.capacityInput&&r.capacityInput(...t)),onInput:e[2]||(e[2]=(...t)=>r.capacityInput&&r.capacityInput(...t)),class:"capacityInput"},null,40,_t)])])}var St={name:"my-capacity",props:{capacity:{type:Number,required:!0}},methods:{capacityInput(t){this.$emit("updateCapacityEvent",t.target.value)}}};const Lt=(0,Q.Z)(St,[["render",wt],["__scopeId","data-v-a96af45a"]]);var Ot=Lt;const Dt={class:"table table-dark table-responsive table-striped table-bordered table-hover"},At={class:"text-center bg-dark"};function Tt(t,e,s,a,r,i){return(0,n.wg)(),(0,n.iD)("div",null,[(0,n._)("table",Dt,[(0,n._)("thead",At,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.table.head,(t=>((0,n.wg)(),(0,n.iD)("th",{key:t},(0,o.zw)(t),1)))),128))]),(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.table.body,((t,e)=>((0,n.wg)(),(0,n.iD)("tr",{key:e},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t,((t,e)=>((0,n.wg)(),(0,n.iD)("td",{key:"index_ceil"+e},(0,o.zw)(t),1)))),128))])))),128))])])])}var Nt={name:"table-result",props:{table:{type:Object,required:!0}}};const xt=(0,Q.Z)(Nt,[["render",Tt],["__scopeId","data-v-e2d9f0fc"]]);var jt=xt,Et=s(400),Ut=s.n(Et);const Rt=(0,n._)("h5",null,"Способ доставки",-1),Pt={class:"form-check form-check-inline"},qt=["disabled","checked"],Bt=(0,n._)("label",{class:"form-check-label",for:"typeTransportAuto"},[(0,n._)("i",{class:"fa fa-car","aria-hidden":"true"})],-1),Gt={class:"form-check form-check-inline"},Yt=["disabled","checked"],$t=(0,n._)("label",{class:"form-check-label",for:"typeTransportBicycle"},[(0,n._)("i",{class:"fa fa-bicycle","aria-hidden":"true"})],-1),Vt={class:"form-check form-check-inline"},Wt=["disabled","checked"],Zt=(0,n._)("label",{class:"form-check-label",for:"typeTransportPedestrian"},[(0,n._)("i",{class:"fas fa-walking"})],-1);function zt(t,e,s,a,o,r){return(0,n.wg)(),(0,n.iD)("div",null,[Rt,(0,n._)("div",Pt,[(0,n._)("input",{class:"form-check-input",type:"radio",id:"typeTransportAuto",name:"typeTransport",value:"auto",disabled:t.isInputDisabled,checked:"auto"==s.typeTransport,onChange:e[0]||(e[0]=t=>r.typeTransportUpdate("auto"))},null,40,qt),Bt]),(0,n._)("div",Gt,[(0,n._)("input",{class:"form-check-input",type:"radio",id:"typeTransportBicycle",name:"typeTransport",value:"bicycle",disabled:t.isInputDisabled,checked:"bicycle"==s.typeTransport,onChange:e[1]||(e[1]=t=>r.typeTransportUpdate("bicycle"))},null,40,Yt),$t]),(0,n._)("div",Vt,[(0,n._)("input",{class:"form-check-input",type:"radio",id:"typeTransportPedestrian",name:"typeTransport",value:"pedestrian",disabled:t.isInputDisabled,checked:"pedestrian"==s.typeTransport,onChange:e[2]||(e[2]=t=>r.typeTransportUpdate("pedestrian"))},null,40,Wt),Zt])])}var Ht={name:"TypeTransport",data(){return{}},props:{typeTransport:{type:String,required:!0}},methods:{typeTransportUpdate(t){this.$emit("typeTransportUpdateEvent",t)}},computed:{...(0,U.rn)({isInputDisabled:t=>t.GlobalSettingModule.isInputDisabled})}};const Kt=(0,Q.Z)(Ht,[["render",zt]]);var Ft=Kt;const Jt=(0,n._)("h5",null,"Способ измерения",-1),Qt={class:"form-check form-check-inline"},Xt=["disabled","checked"],te=(0,n._)("label",{class:"form-check-label",for:"typeMetricsDistance"},[(0,n._)("i",{class:"fa fa-road","aria-hidden":"true"})],-1),ee={class:"form-check form-check-inline"},se=["disabled","checked"],ae=(0,n._)("label",{class:"form-check-label",for:"typeMetricsDuration"},[(0,n._)("i",{class:"fa fa-clock"})],-1);function ne(t,e,s,a,o,r){return(0,n.wg)(),(0,n.iD)("div",null,[Jt,(0,n._)("div",Qt,[(0,n._)("input",{class:"form-check-input",type:"radio",id:"typeMetricsDistance",name:"typeMetrics",value:"distances",disabled:t.isInputDisabled,checked:"distances"==s.typeMeasurement,onChange:e[0]||(e[0]=t=>r.typeMeasurementUpdate("distances"))},null,40,Xt),te]),(0,n._)("div",ee,[(0,n._)("input",{class:"form-check-input",type:"radio",id:"typeMetricsDuration",name:"typeMetrics",value:"durations",disabled:t.isInputDisabled,checked:"durations"==s.typeMeasurement,onChange:e[1]||(e[1]=t=>r.typeMeasurementUpdate("durations"))},null,40,se),ae])])}var oe={name:"metrics-change",props:{typeMeasurement:{type:String,required:!0}},methods:{typeMeasurementUpdate(t){this.$emit("typeMeasurementUpdateEvent",t)}},computed:{...(0,U.rn)({isInputDisabled:t=>t.GlobalSettingModule.isInputDisabled})}};const re=(0,Q.Z)(oe,[["render",ne]]);var ie=re,ue=s(7092),le={name:"App",components:{TableResult:jt,MyCapacity:Ot,RouteCalculation:bt,YandexMarkers:ht,MySuggests:at,TypeTransport:Ft,TypeMetrics:ie},data:function(){return{errorMessage:"",isComputedLoad:!1,isMapLoad:!1,isEmptyLocalStorage:!0,typeTransport:"auto",typeMeasurement:"distances",mapCenter:[55.751244,37.618423],mapZoom:10,mainMap:{id:(0,nt.Z)()},capacity:1,suggestsStore:this.defaultSuggest(),suggestsDestination:this.defaultSuggest(),routes:{distribution:[],ways:[],atMapObjects:[],colors:["#ff0000","#0000ff","#00ff00","#ffff00","#ffa500","#800080","#000000","#ffffff","#808080","#40e0d0","#00ffff","#ff1493","#a52a2a","#800000","#800080","#00ff00","#ffff00","#ff69b4","#8b0000","#1e90ff","#006400","#f08080","#ff8c00","#9932cc","#008080","#ffa07a","#7fffd4","#ff00ff","#f4a460","#7cfc00","#da70d6","#00fa9a","#dda0dd","#8fbc8f","#4682b4","#d8bfd8","#32cd32","#f5f5dc","#000080","#b0c4de","#ff4500","#228b22","#fa8072","#90ee90","#778899","#ffebcd","#00ced1","#d3d3d3","#7b68ee","#f0e68c","#4b0082","#bdb76b","#2e8b57","#bc8f8f","#ff6347","#6b8e23","#9370db","#3cb371","#afeeee","#191970","#ff7f50","#556b2f","#dda0dd","#add8e6","#8b4513","#8b4513"]},table:{head:[],body:[]}}},methods:{defaultSuggestValue(){return{id:(0,nt.Z)(),value:"",count:1,atMapObjectsIndexes:[]}},defaultSuggest(){return{values:[this.defaultSuggestValue()],markers:[]}},updateInput(t,e,s){s.values[e].value=t,this.markerCheck(e,s)},updateCount(t,e,s){t=Number(t),s.values[e].count=t,s.values[e].count<1&&(s.values[e].count=1),s===this.suggestsStore?this.LocalStorageSetItem("values","suggestsStore","suggestsStoreValues"):this.LocalStorageSetItem("values","suggestsDestination","suggestsDestinationValues")},updateMarkerObject(t,e,s){s[e].object=t},updateCapacity(t){this.capacity=Number(t)},typeTransportUpdate(t){this.typeTransport=t},typeMeasurementUpdate(t){this.typeMeasurement=t},showErrorMessage(){this.errorMessage="Ошибка!\nНе был найден путь между некоторыми адресами",setTimeout((()=>{this.errorMessage=""}),1e4)},markerLoad(t,e,s){let a=e.markers,n=e.values;a.length-1<t&&a.push({id:(0,nt.Z)(),coords:null,object:null,type:e===this.suggestsStore?"store":"destination"}),a[t].coords=s,n.length-1===t&&n.push(this.defaultSuggestValue())},markerCheck(t,e){let s=e.values,a=e.markers,n=s[t].value;0===n.length&&(n=" "),window.ymaps.geocode(n).then((n=>{const o=n.geoObjects;if(o.getLength()>0){const s=o.get(0).geometry.getCoordinates();this.markerLoad(t,e,s)}else a[t].coords=null,setTimeout((()=>{s.length>1&&s[t].value<2&&t!==s.length-1?(s.splice(t,1),a.splice(t,1)):s.length>1&&t===s.length-2&&s[s.length-1].value.length<2&&s.splice(s.length-1,1)}),100)})),setTimeout((()=>{e===this.suggestsStore?(this.LocalStorageSetItem("values","suggestsStore","suggestsStoreValues"),this.LocalStorageSetItem("filteredStoreCoords",null,"storeCoords")):(this.LocalStorageSetItem("values","suggestsDestination","suggestsDestinationValues"),this.LocalStorageSetItem("filteredDestinationCoords",null,"destinationCoords"))}),200)},filteredNewCoords(t){return t.map((t=>t.coords))},CountPoint(t){return t.map((t=>t.count)).slice(0,-1)},updateRoutes(t){this.removeRotesAtMap(),this.routes.distribution=t.distribution,this.routes.ways=t.ways,this.updateRoutesAtMap(),this.tableCreate(),this.LocalStorageSetItem("table")},updateRoutesAtMap(){for(let r=0;r<this.suggestsStore.values.length;r++)this.suggestsStore.values[r].atMapObjectsIndexes=[];for(let r=0;r<this.suggestsDestination.values.length;r++)this.suggestsDestination.values[r].atMapObjectsIndexes=[];this.routes.atMapObjects=[];let t=this.store.state.MainMapModule.MainMap.__v_raw;for(var e=0;e<this.routes.distribution.length;e++)for(var s=0;s<this.routes.distribution[e].length;s++)if(0!==this.routes.distribution[e][s]){if(0===this.routes.ways.__v_raw[e][s].length)continue;let r=[this.filteredStoreCoords[e]];for(var a=0;a<this.routes.ways.__v_raw[e][s].length;a++)r.push(this.filteredDestinationCoords[this.routes.ways.__v_raw[e][s][a]]);var n=new window.ymaps.multiRouter.MultiRoute({referencePoints:r,params:{routingMode:this.typeTransport}},{routeActiveStrokeColor:this.routes.colors[this.routes.atMapObjects.length],boundsAutoApply:!0,wayPointDraggable:!1,viaPointDraggable:!1,avoidTrafficJams:!1});t.geoObjects.add(n),this.routes.atMapObjects.push(n);let i=this.routes.atMapObjects.length-1;this.suggestsStore.values[e].atMapObjectsIndexes.push(i);for(var o=0;o<this.routes.ways.__v_raw[e][s].length;o++)this.suggestsDestination.values[this.routes.ways.__v_raw[e][s][o]].atMapObjectsIndexes.push(i)}},OnlyNeedRoutesToMap(t){this.removeRotesAtMap();let e=this.store.state.MainMapModule.MainMap.__v_raw,s=t.map((t=>this.routes.atMapObjects[t].__v_raw));for(var a=0;a<s.length;a++)e.geoObjects.add(s[a])},AllRoutesToMap(){this.removeRotesAtMap();let t=this.store.state.MainMapModule.MainMap.__v_raw;for(var e=0;e<this.routes.atMapObjects.length;e++)t.geoObjects.add(this.routes.atMapObjects[e].__v_raw)},removeRotesAtMap(){let t=this.store.state.MainMapModule.MainMap.__v_raw;for(var e=0;e<this.routes.atMapObjects.length;e++){let s=this.routes.atMapObjects[e].__v_raw;t.geoObjects.remove(s)}},tableCreate(){this.table.head=[],this.table.head.push("Адрес поставщика");let t=0;this.table.body=[],this.table.maxLineLength=0;for(var e=0;e<this.routes.ways.length;e++)for(var s=0;s<this.routes.ways[e].length;s++)if(this.routes.ways[e][s].length>0){let n=[];n.push(this.suggestsStore.values[e].value);let o=0;for(var a=0;a<this.routes.ways[e][s].length;a++){let t=this.routes.ways[e][s][a];n.push(this.suggestsDestination.values[t].value+" ("+this.routes.distribution[e][t]+")"),o+=1}this.table.body.push(n),o>t&&(t=o)}for(var n=0;n<t;n++)this.table.head.push("Поставка "+(n+1))},LocalStorageGetItem(t,e=null,s=t,a=!1){const n=JSON.parse(localStorage.getItem(s));return void 0!==n&&null!==n&&(a?n:void(null!==e?this[e][t]=n:this[t]=n))},LocalStorageSetItem(t,e=null,s=t){this.isEmptyLocalStorage=!1;let a=null;a=null!==e?Ut().stringify(this[e][t]):Ut().stringify(this[t]),localStorage.setItem(s,a)},MarkersLocalLoad(t,e){if(e)for(var s=0;s<e.length;s++)null!==e[s]&&this.markerLoad(s,t,e[s])},LocalAllLoad(){this.LocalStorageGetItem("values","suggestsStore","suggestsStoreValues"),this.LocalStorageGetItem("values","suggestsDestination","suggestsDestinationValues"),this.LocalStorageGetItem("capacity"),this.LocalStorageGetItem("typeTransport"),this.LocalStorageGetItem("typeMeasurement"),this.LocalStorageGetItem("distribution","routes"),this.LocalStorageGetItem("ways","routes"),this.LocalStorageGetItem("table");let t=this.LocalStorageGetItem("storeCoords",null,"storeCoords",!0),e=this.LocalStorageGetItem("destinationCoords",null,"destinationCoords",!0);(t||e)&&this.WhenMapLoad((()=>{this.MarkersLocalLoad(this.suggestsStore,t),this.MarkersLocalLoad(this.suggestsDestination,e)})),this.filteredStoreCoords.length>0&&this.filteredDestinationCoords.length>0?(this.WhenMapLoad(this.updateRoutesAtMap),this.isComputedLoad=!0):(0,n.YP)((()=>this.filteredStoreCoords),(t=>{t.length>0&&!1===this.isComputedLoad&&(this.WhenMapLoad(this.updateRoutesAtMap),this.isComputedLoad=!0)}))},RemoveLocalData(){localStorage.clear(),this.isEmptyLocalStorage=!0,this.capacity=1,this.typeTransport="auto",this.typeMeasurement="distances",this.suggestsStore=this.defaultSuggest(),this.suggestsDestination=this.defaultSuggest(),this.routes.ways=[],this.routes.distribution=[],this.routes.atMapObjects=[],this.table={body:[],head:[]};let t=this.$store.state.MainMapModule.MainMap.__v_raw;t.geoObjects.removeAll()},WhenMapLoad(t){null!=this.store.state.MainMapModule.MainMap?(t(),this.isMapLoad=!0):(0,n.YP)((()=>this.store.state.MainMapModule.MainMap),(e=>{null!==e&&!1===this.isMapLoad&&(t(),this.isMapLoad=!0)}))}},setup(){let t=(0,U.oR)();const e=()=>{t.dispatch("YAPIModule/CheckConnectAPI")};return(0,n.bv)((()=>{e()})),{store:t}},mounted(){0!==localStorage.length&&(this.isEmptyLocalStorage=!1,this.LocalAllLoad())},computed:{filteredMarkers(){return this.suggestsStore.markers.concat(this.suggestsDestination.markers)},filteredStoreCoords(){return this.filteredNewCoords(this.suggestsStore.markers)},filteredDestinationCoords(){return this.filteredNewCoords(this.suggestsDestination.markers)},StoreCoordsNOTNULL(){return this.filteredStoreCoords.filter((t=>null!==t))},DestinationCoordsNOTNULL(){return this.filteredDestinationCoords.filter((t=>null!==t))},storeCount(){return this.CountPoint(this.suggestsStore.values)},destinationCount(){return this.CountPoint(this.suggestsDestination.values)},IsMinCoords(){return this.StoreCoordsNOTNULL.length>1&&this.DestinationCoordsNOTNULL.length>1},...(0,U.rn)("GlobalSettingModule",["isInputDisabled"]),excelLink(){if(this.table.head.length>0){const t=ue.P6.book_new();let e=[];e.push(this.table.head),e=e.concat(this.table.body);const s=ue.P6.aoa_to_sheet(e);ue.P6.book_append_sheet(t,s,"Лист 1");const a=ue.cW(t,{bookType:"xlsx",type:"array"}),n=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),o=URL.createObjectURL(n);return o}return""}},watch:{capacity(){1!==this.capacity&&this.LocalStorageSetItem("capacity")},typeTransport(){"auto"!==this.typeTransport&&this.LocalStorageSetItem("typeTransport")},typeMeasurement(){"distances"!==this.typeMeasurement&&this.LocalStorageSetItem("typeMeasurement")},"routes.ways"(){0===this.routes.ways.length&&0===this.routes.distribution.length?(localStorage.removeItem("ways"),localStorage.removeItem("distribution")):(this.LocalStorageSetItem("ways","routes"),this.LocalStorageSetItem("distribution","routes"))}}};const ce=(0,Q.Z)(le,[["render",E]]);var de=ce;const pe={ref:"map",className:"map"};function he(t,e,s,a,o,r){return(0,n.wg)(),(0,n.iD)("div",null,[(0,n._)("div",pe,[(0,n.WI)(t.$slots,"default",{},void 0,!0)],512)])}var ge=s(4870),me={name:"yandex-map",props:{center:{type:Array,required:!0},zoom:{type:Number,default:10}},setup(t){const e=(0,ge.iH)(null);let s=(0,U.oR)(),a=null;const o=()=>{window.ymaps&&window.ymaps.Map&&(a=new window.ymaps.Map(e.value,{center:t.center,zoom:t.zoom,controls:[]}),s.commit("MainMapModule/setMap",a))};return s.state.YAPIModule.connected?o():(0,n.YP)((()=>s.state.YAPIModule.connected),(t=>{t&&o()})),{map:e,store:s}}};const ye=(0,Q.Z)(me,[["render",he],["__scopeId","data-v-3515ac80"]]);var fe=ye,ve=[fe,ht,ct,at,tt,bt,Ot,jt,Ft,ie];const be={namespaced:!0,state:()=>({API_key:"1f2568c2-9262-4943-ad8f-fb28a2c7b561",version:2.1,connected:!1,YAPI_url:"https://api-maps.yandex.ru/2.1/?apikey=1f2568c2-9262-4943-ad8f-fb28a2c7b561&lang=ru_RU"}),getters:{},mutations:{},actions:{CheckConnectAPI({state:t}){if(!t.connected){let e=setInterval((()=>{window.ymaps&&window.ymaps.Map&&(t.connected=!0,clearInterval(e))}),100)}}}},Me={namespaced:!0,state:()=>({MainMap:null}),getters:{},mutations:{setMap(t,e){t.MainMap=e}},actions:{}},Ie={namespaced:!0,state:()=>({isInputDisabled:!1}),getters:{},mutations:{setIsInputDisabled(t,e){t.isInputDisabled=e}},actions:{}};var ke=(0,U.MT)({modules:{YAPIModule:be,MainMapModule:Me,GlobalSettingModule:Ie}});const Ce=(0,a.ri)(de);ve.forEach((t=>{Ce.component(t.name,t)})),Ce.use(ke).mount("#app")},4700:function(t,e,s){var a={"./arhivIcon/destinationIcon.png":7534,"./arhivIcon/storeIcon.png":1033,"./clearIcon.png":4617,"./destinationIcon.png":449,"./storeIcon.png":2217};function n(t){var e=o(t);return s(e)}function o(t){if(!s.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}n.keys=function(){return Object.keys(a)},n.resolve=o,t.exports=n,n.id=4700},7534:function(t,e,s){"use strict";t.exports=s.p+"img/destinationIcon.88bccd7f.png"},1033:function(t,e,s){"use strict";t.exports=s.p+"img/storeIcon.4770481d.png"},4617:function(t,e,s){"use strict";t.exports=s.p+"img/clearIcon.34bd5aa8.png"},449:function(t,e,s){"use strict";t.exports=s.p+"img/destinationIcon.b1f64b19.png"},2217:function(t,e,s){"use strict";t.exports=s.p+"img/storeIcon.19ea9f3e.png"}},e={};function s(a){var n=e[a];if(void 0!==n)return n.exports;var o=e[a]={exports:{}};return t[a].call(o.exports,o,o.exports,s),o.exports}s.m=t,function(){var t=[];s.O=function(e,a,n,o){if(!a){var r=1/0;for(c=0;c<t.length;c++){a=t[c][0],n=t[c][1],o=t[c][2];for(var i=!0,u=0;u<a.length;u++)(!1&o||r>=o)&&Object.keys(s.O).every((function(t){return s.O[t](a[u])}))?a.splice(u--,1):(i=!1,o<r&&(r=o));if(i){t.splice(c--,1);var l=n();void 0!==l&&(e=l)}}return e}o=o||0;for(var c=t.length;c>0&&t[c-1][2]>o;c--)t[c]=t[c-1];t[c]=[a,n,o]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var a in e)s.o(e,a)&&!s.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){s.p="/"}(),function(){var t={143:0};s.O.j=function(e){return 0===t[e]};var e=function(e,a){var n,o,r=a[0],i=a[1],u=a[2],l=0;if(r.some((function(e){return 0!==t[e]}))){for(n in i)s.o(i,n)&&(s.m[n]=i[n]);if(u)var c=u(s)}for(e&&e(a);l<r.length;l++)o=r[l],s.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return s.O(c)},a=self["webpackChunkwebapp"]=self["webpackChunkwebapp"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=s.O(void 0,[998],(function(){return s(1049)}));a=s.O(a)})();
//# sourceMappingURL=app.646f8053.js.map